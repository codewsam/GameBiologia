<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Perguntas - Jogo Verdadeiro ou Falso</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="p-4">

  <div class="equipes-container mx-auto" style="max-width:900px;">
    <div class="equipe-atual" id="equipeAtualBox">
      <h3>Vez de: <span id="nomeEquipeAtual">-</span></h3>
    </div>

    <div id="placar" class="mb-3" style="text-align:center;">
      <strong>Placar:</strong> <span id="placarText">Equipe 1: 0 — Equipe 2: 0</span>
    </div>

    <div class="pergunta-container" id="perguntaContainer">
      <h2 id="perguntaTexto">Carregando...</h2>
      <p>Peso: <span id="pesoPergunta">-</span></p>

      <div class="botoes">
        <button type="button" id="btnVerdadeiro" class="btn-resposta">Verdadeiro</button>
        <button type="button" id="btnFalso" class="btn-resposta">Falso</button>
      </div>

      <div id="feedback" class="feedback" style="display:none;">
        <p id="resultadoResposta"></p>
      </div>

      <!-- Professor valida a opção -->
      <div id="areaJustificativa" style="display:none;">
        <p>Justificou certo?</p>
        <button class="btn-mini" id="justificativaSim">Sim</button>
        <button class="btn-mini" id="justificativaNao">Não</button>
      </div>

      <!-- Se NÃO, aparece o desafio -->
      <div id="area-desafio" style="display:none;">
        <span>Equipe adversária (<strong id="nomeAdversaria"></strong>) quer desafiar?</span>
        <div style="margin-top:10px;">
          <button class="btn-mini" id="desafioSim">Sim</button>
          <button class="btn-mini" id="desafioNao">Não</button>
        </div>
      </div>

      <!-- Justificativa (aparece quando a resposta estiver correta e pergunta tiver peso>1) -->
      <div id="areaJustificativaTexto" style="display:none; margin-top:20px;">
        <label for="justificativa">Enviar justificativa (moderador irá validar):</label>
        <textarea id="justificativa" rows="4" style="width:100%; border-radius:10px; padding:8px;"></textarea>
        <div style="text-align:center; margin-top:10px;">
          <button id="enviarJust" class="btn-continuar">Enviar justificativa</button>
        </div>
      </div>

      <!-- Controles do moderador para validar justificativa -->
      <div id="controlesModerador" style="display:none; margin-top:15px; text-align:center;">
        <p><small>Moderador: marque a justificativa</small></p>
        <button id="justOk" class="btn-mini">Justificativa correta</button>
        <button id="justBad" class="btn-mini">Justificativa incorreta</button>
      </div>

      <div style="text-align:center; margin-top:20px;">
        <button id="proxima" class="btn-continuar" style="display:none;">Próxima pergunta</button>
      </div>
    </div>

    <div id="placarFinal" style="display:none; margin-top:25px;">
      <h3>Placar Final</h3>
      <ul id="listaFinal"></ul>
      <button id="reiniciar" class="btn-continuar">Reiniciar jogo</button>
    </div>
  </div>

  <script>
    // Pontuação: base 1 ponto para resposta correta sem justificativa.
    // Se justificar corretamente, ganha o peso total (3|4|5).
    let equipes = JSON.parse(localStorage.getItem('equipes')) || [
      { nome: "Equipe 1", pontos: 0 },
      { nome: "Equipe 2", pontos: 0 }
    ];
    let equipeIndex = 0;
    let indicePergunta = 0;
    let desafioChallenger = null;
    let basePointGiven = false;

   let perguntas = [
  // Peso 3 (par 1)
  { texto: "O vírus HIV é transmitido somente através de relações sexuais desprotegidas.", resposta: false, peso: 3 },
  { texto: "O HPV infecta apenas a pele da região genital.", resposta: false, peso: 3 },

  // Peso 4 (par 1)
  { texto: "As ISTs que causam úlceras ou inflamação genital podem facilitar a transmissão e a aquisição do HIV.", resposta: true, peso: 4 },
  { texto: "A sífilis não tratada pode evoluir para a Neurossífilis, afetando o sistema nervoso e causando danos cerebrais ou na medula espinhal.", resposta: true, peso: 4 },

  // Peso 5 (par 1)
  { texto: "O uso consistente de preservativos elimina completamente o risco de contrair qualquer IST.", resposta: false, peso: 5 },
  { texto: "O consentimento é um acordo 'sim ou não' que é dado no início da relação sexual e vale para todo o ato, não podendo ser retirado depois de iniciado.", resposta: false, peso: 5 },

  // Peso 3 (par 2)
  { texto: "O cancro mole e a sífilis primária são facilmente diferenciados porque o cancro da sífilis (duro) é indolor, e o cancro mole é doloroso.", resposta: true, peso: 3 },
  { texto: "O uso de lubrificantes à base de óleo, como vaselina ou óleos corporais, é recomendado em conjunto com preservativos de látex para evitar o atrito e o rompimento.", resposta: false, peso: 3 },

  // Peso 4 (par 2)
  { texto: "A clamídia é frequentemente assintomática, especialmente em mulheres, sendo essa a principal razão para a sua rápida disseminação e a progressão para complicações.", resposta: true, peso: 4 },
  { texto: "É comum que a Gonorreia e a Clamídia ocorram como coinfecção, exigindo tratamento para ambas as bactérias simultaneamente.", resposta: true, peso: 4 },

  // Peso 5 (par 2)
  { texto: "Uma pessoa com HIV que está em tratamento antirretroviral e tem a carga viral indetectável ainda pode transmitir o vírus sexualmente.", resposta: false, peso: 5 },
  { texto: "A vacinação contra o HPV deve ser realizada após o início da atividade sexual para garantir que o organismo possa criar anticorpos contra o vírus.", resposta: false, peso: 5 }
];

    const nomeEquipeAtualEl = document.getElementById("nomeEquipeAtual");
    const placarTextEl = document.getElementById("placarText");
    const perguntaTextoEl = document.getElementById("perguntaTexto");
    const pesoPerguntaEl = document.getElementById("pesoPergunta");
    const btnVerdadeiro = document.getElementById("btnVerdadeiro");
    const btnFalso = document.getElementById("btnFalso");
    const feedbackEl = document.getElementById("feedback");
    const resultadoRespostaEl = document.getElementById("resultadoResposta");
    const areaJustificativa = document.getElementById("areaJustificativa");
    const areaDesafio = document.getElementById("area-desafio");
    const nomeAdversariaEl = document.getElementById("nomeAdversaria");
    const justificativaSim = document.getElementById("justificativaSim");
    const justificativaNao = document.getElementById("justificativaNao");
    const desafioSim = document.getElementById("desafioSim");
    const desafioNao = document.getElementById("desafioNao");
    const controlesModerador = document.getElementById("controlesModerador");
    const justOk = document.getElementById("justOk");
    const justBad = document.getElementById("justBad");
    const proximaBtn = document.getElementById("proxima");
    const placarFinal = document.getElementById("placarFinal");
    const listaFinal = document.getElementById("listaFinal");
    const reiniciarBtn = document.getElementById("reiniciar");

    function atualizarPlacarDOM() {
      placarTextEl.textContent = `${equipes[0].nome}: ${equipes[0].pontos} — ${equipes[1].nome}: ${equipes[1].pontos}`;
    }

    function atualizarEquipeAtualDOM() {
      nomeEquipeAtualEl.textContent = equipes[equipeIndex].nome;
    }

    function mostrarPergunta() {
      atualizarEquipeAtualDOM();
      atualizarPlacarDOM();
      feedbackEl.style.display = "none";
      areaJustificativa.style.display = "none";
      areaDesafio.style.display = "none";
      controlesModerador.style.display = "none";
      proximaBtn.style.display = "none";
      btnVerdadeiro.disabled = false;
      btnFalso.disabled = false;
      basePointGiven = false;
      desafioChallenger = null;

      if (indicePergunta >= perguntas.length) {
        perguntaTextoEl.textContent = "Fim do jogo!";
        pesoPerguntaEl.textContent = "-";
        document.querySelector(".botoes").style.display = "none";
        placarFinal.style.display = "block";
        listaFinal.innerHTML = "";
        equipes.forEach(e => {
          const li = document.createElement("li");
          li.textContent = `${e.nome}: ${e.pontos} pontos`;
          listaFinal.appendChild(li);
        });
        return;
      }
      perguntaTextoEl.textContent = perguntas[indicePergunta].texto;
      pesoPerguntaEl.textContent = perguntas[indicePergunta].peso;
      document.querySelector(".botoes").style.display = "block";
    }

    function handleResposta(chute) {
      btnVerdadeiro.disabled = true;
      btnFalso.disabled = true;
      const acertou = chute === perguntas[indicePergunta].resposta;
      resultadoRespostaEl.textContent = acertou ? "Acertou!" : "Errou!";
      feedbackEl.style.display = "block";

      if (acertou) {
        // time atual acertou -> professor verifica justificativa
        areaJustificativa.style.display = "block";
        areaJustificativa.dataset.acertou = "1";
      } else {
        // time atual errou -> pergunta imediatamente se a equipe adversária quer desafiar
        areaJustificativa.style.display = "none";
        areaJustificativa.dataset.acertou = "0";
        nomeAdversariaEl.textContent = equipes[1 - equipeIndex].nome;
        areaDesafio.style.display = "block";
      }
    }

    // Professor confirma que a justificativa do time atual estava correta:
    justificativaSim.addEventListener('click', function() {
      const peso = perguntas[indicePergunta].peso || 1;
      // ganha o peso total
      equipes[equipeIndex].pontos += peso;
      atualizarPlacarDOM();
      areaJustificativa.style.display = "none";
      feedbackEl.style.display = "none";
      indicePergunta++;
      proximaEquipe();
      mostrarPergunta();
    });

    // Professor indica que a justificativa está incorreta:
    justificativaNao.addEventListener('click', function() {
      // concede o ponto base (resposta correta sem justificativa)
      equipes[equipeIndex].pontos += 1;
      atualizarPlacarDOM();
      areaJustificativa.style.display = "none";
      // pergunta se a equipe adversária quer desafiar
      nomeAdversariaEl.textContent = equipes[1 - equipeIndex].nome;
      areaDesafio.style.display = "block";
      basePointGiven = true;
    });

    // Adversária decide desafiar:
    desafioSim.addEventListener('click', function() {
      areaDesafio.style.display = "none";
      // mostra controles do moderador para validar justificativa do desafiante
      controlesModerador.style.display = "block";
      desafioChallenger = 1 - equipeIndex;
    });

    // Adversária não desafia => segue para próxima
    desafioNao.addEventListener('click', function() {
      areaDesafio.style.display = "none";
      feedbackEl.style.display = "none";
      // se respostas erradas não dão ponto, só avançamos; se era justificativa incorreta, o time já recebeu 1 ponto
      indicePergunta++;
      proximaEquipe();
      mostrarPergunta();
    });

    // Moderador marca justificativa do desafiante como correta:
    justOk.addEventListener('click', function() {
      if (desafioChallenger === null) return;
      const peso = perguntas[indicePergunta].peso || 1;
      // remove o ponto base do time original se já foi dado
      if (basePointGiven) {
        equipes[equipeIndex].pontos = Math.max(0, equipes[equipeIndex].pontos - 1);
        basePointGiven = false;
      }
      // desafiante ganha o peso total
      equipes[desafioChallenger].pontos += peso;
      atualizarPlacarDOM();
      controlesModerador.style.display = "none";
      feedbackEl.style.display = "none";
      indicePergunta++;
      proximaEquipe();
      mostrarPergunta();
    });

    // Moderador marca justificativa do desafiante como incorreta:
    justBad.addEventListener('click', function() {
      // desafiante falhou -> mantém o ponto base do time original (se já dado) e segue
      controlesModerador.style.display = "none";
      feedbackEl.style.display = "none";
      indicePergunta++;
      proximaEquipe();
      mostrarPergunta();
    });

    // Botões de avanço e reinício
    proximaBtn.addEventListener('click', function() {
      indicePergunta++;
      proximaEquipe();
      mostrarPergunta();
    });

    reiniciarBtn.addEventListener('click', function() {
      location.reload();
    });

    btnVerdadeiro.addEventListener('click', function() { handleResposta(true); });
    btnFalso.addEventListener('click', function() { handleResposta(false); });

    function proximaEquipe() {
      equipeIndex = 1 - equipeIndex;
    }

    // Inicialização
    mostrarPergunta();
  </script>
</body>
</html>
